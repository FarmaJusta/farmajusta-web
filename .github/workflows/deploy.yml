name: FarmaJusta Deploy Pipeline

env:
    VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
    VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}

on:
    push:
        branches:
            - main

    workflow_dispatch:

jobs:
    Deploy-Development:
        if: github.event_name == 'push'
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - name: Instalar Vercel CLI
              run: npm install --global vercel@latest
            - name: Bajar entorno DEV (Pull)
              run: vercel pull --yes --environment=preview --token=${{ secrets.VERCEL_TOKEN }}
            - name: Construir Proyecto (Build)
              run: vercel build --token=${{ secrets.VERCEL_TOKEN }}
            - name: Desplegar a DEV (Deploy)
              run: vercel deploy --prebuilt --token=${{ secrets.VERCEL_TOKEN }}

    Deploy-Production:
        if: github.event_name == 'workflow_dispatch'
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - name: Instalar Vercel CLI
              run: npm install --global vercel@latest
            - name: Bajar entorno PROD (Pull)
              run: vercel pull --yes --environment=production --token=${{ secrets.VERCEL_TOKEN }}
            - name: Construir Proyecto (Build)
              run: vercel build --prod --token=${{ secrets.VERCEL_TOKEN }}
            - name: Desplegar a PRODUCCIÃ“N (Deploy)
              run: vercel deploy --prebuilt --prod --token=${{ secrets.VERCEL_TOKEN }}
